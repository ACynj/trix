[0;32m[INFO][0m æ­£åœ¨æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ: trix
[0;32m[INFO][0m è™šæ‹ŸçŽ¯å¢ƒ trix å·²æ¿€æ´»
[0;32m[INFO][0m å½“å‰å·¥ä½œç›®å½•: /T20030104/ynj/TRIX
[0;32m[INFO][0m å¼€å§‹è¯»å–å‘½ä»¤æ–‡ä»¶: command_rel.md
[0;32m[INFO][0m æ—¥å¿—å°†ä¿å­˜åˆ°: run_commands_20260105_113925.log
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 1: python src/run_relation.py -c ./config/run_relation_transductive_mech.yaml --dataset CoDExSmall --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 11:39:26
11:39:28   Random seed: 128
11:39:28   Config file: ./config/run_relation_transductive_mech.yaml
11:39:28   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'CoDExSmall',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
11:39:29   CoDExSmall dataset
11:39:29   #train: 32888, #valid: 1827, #test: 1828
11:39:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
11:39:29   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
11:40:22   mr: 1.21663
11:40:22   mrr: 0.963891
11:40:22   hits@1: 0.937637
11:40:22   hits@3: 0.990153
11:40:22   hits@10: 0.993982
[0;32m[INFO][0m âœ“ å‘½ä»¤ 1 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 11:40:23
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 2: python src/run_relation.py -c ./config/run_relation_transductive_mech_1.yaml --dataset CoDExLarge --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 11:40:23
11:40:25   Random seed: 128
11:40:25   Config file: ./config/run_relation_transductive_mech_1.yaml
11:40:25   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'CoDExLarge',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 8,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
11:40:27   CoDExLarge dataset
11:40:27   #train: 551193, #valid: 30622, #test: 30622
11:40:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
11:40:28   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
12:54:07   mr: 1.49794
12:54:07   mrr: 0.88821
12:54:07   hits@1: 0.811181
12:54:07   hits@3: 0.960649
12:54:07   hits@10: 0.991738
[0;32m[INFO][0m âœ“ å‘½ä»¤ 2 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 12:54:08
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 3: python src/run_relation.py -c ./config/run_relation_transductive_mech.yaml --dataset NELL995 --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 12:54:08
12:54:10   Random seed: 128
12:54:10   Config file: ./config/run_relation_transductive_mech.yaml
12:54:10   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NELL995',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
12:54:11   NELL995 dataset
12:54:11   #train: 149678, #valid: 543, #test: 2818
12:54:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:54:11   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
12:54:41   mr: 11.4847
12:54:41   mrr: 0.578195
12:54:41   hits@1: 0.456352
12:54:41   hits@3: 0.667495
12:54:41   hits@10: 0.765436
[0;32m[INFO][0m âœ“ å‘½ä»¤ 3 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 12:54:42
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 4: python src/run_relation.py -c ./config/run_relation_transductive_mech_1.yaml --dataset DBpedia100k --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 12:54:42
12:54:44   Random seed: 128
12:54:44   Config file: ./config/run_relation_transductive_mech_1.yaml
12:54:44   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'DBpedia100k',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 8,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
12:54:46   DBpedia100k dataset
12:54:46   #train: 597572, #valid: 50000, #test: 50000
12:54:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:54:47   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
14:09:08   mr: 5.2201
14:09:08   mrr: 0.716853
14:09:08   hits@1: 0.58072
14:09:08   hits@3: 0.83142
14:09:08   hits@10: 0.93056
[0;32m[INFO][0m âœ“ å‘½ä»¤ 4 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 14:09:09
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 5: python src/run_relation.py -c ./config/run_relation_transductive_mech_1.yaml --dataset ConceptNet100k --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 14:09:09
14:09:12   Random seed: 128
14:09:12   Config file: ./config/run_relation_transductive_mech_1.yaml
14:09:12   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'ConceptNet100k',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 8,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
14:09:12   ConceptNet100k dataset
14:09:12   #train: 100000, #valid: 1200, #test: 1200
14:09:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:09:12   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
14:09:39   mr: 2.16167
14:09:39   mrr: 0.680865
14:09:39   hits@1: 0.4875
14:09:39   hits@3: 0.856667
14:09:39   hits@10: 0.989167
[0;32m[INFO][0m âœ“ å‘½ä»¤ 5 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 14:09:40
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 6: python src/run_relation.py -c ./config/run_relation_transductive_mech.yaml --dataset NELL23k --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 14:09:40
14:09:43   Random seed: 128
14:09:43   Config file: ./config/run_relation_transductive_mech.yaml
14:09:43   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NELL23k',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
14:09:43   NELL23k dataset
14:09:43   #train: 25445, #valid: 4961, #test: 4952
14:09:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:09:43   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
14:10:01   mr: 6.10844
14:10:01   mrr: 0.782053
14:10:01   hits@1: 0.688409
14:10:01   hits@3: 0.863893
14:10:01   hits@10: 0.92609
[0;32m[INFO][0m âœ“ å‘½ä»¤ 6 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 14:10:01
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 7: python src/run_relation.py -c ./config/run_relation_transductive_mech_1.yaml --dataset YAGO310 --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 14:10:01
14:10:04   Random seed: 128
14:10:04   Config file: ./config/run_relation_transductive_mech_1.yaml
14:10:04   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'YAGO310',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 8,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
14:10:06   YAGO310 dataset
14:10:06   #train: 1079040, #valid: 5000, #test: 5000
14:10:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:10:06   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
14:22:06   mr: 2.6802
14:22:06   mrr: 0.529382
14:22:06   hits@1: 0.3002
14:22:06   hits@3: 0.7282
14:22:06   hits@10: 0.995
[0;32m[INFO][0m âœ“ å‘½ä»¤ 7 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 14:22:06
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 8: python src/run_relation.py -c ./config/run_relation_transductive_mech_1.yaml --dataset Hetionet --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 14:22:06
14:22:09   Random seed: 128
14:22:09   Config file: ./config/run_relation_transductive_mech_1.yaml
14:22:09   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'Hetionet',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 8,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
14:22:11   Hetionet dataset
14:22:11   #train: 2025177, #valid: 112510, #test: 112510
14:22:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:22:11   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:02:22   mr: 1.34128
17:02:22   mrr: 0.865621
17:02:22   hits@1: 0.763159
17:02:22   hits@3: 0.990072
17:02:22   hits@10: 0.999947
[0;32m[INFO][0m âœ“ å‘½ä»¤ 8 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:02:22
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 9: python src/run_relation.py -c ./config/run_relation_transductive_mech_1.yaml --dataset WDsinger --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:02:22
17:02:25   Random seed: 128
17:02:25   Config file: ./config/run_relation_transductive_mech_1.yaml
17:02:25   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WDsinger',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 8,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:02:25   WDsinger dataset
17:02:25   #train: 16142, #valid: 2163, #test: 2203
17:02:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:25   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:02:36   mr: 4.25148
17:02:36   mrr: 0.73647
17:02:36   hits@1: 0.625057
17:02:36   hits@3: 0.825238
17:02:36   hits@10: 0.903314
[0;32m[INFO][0m âœ“ å‘½ä»¤ 9 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:02:36
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 10: python src/run_relation.py -c ./config/run_relation_transductive_mech_1.yaml --dataset AristoV4 --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:02:36
17:02:39   Random seed: 128
17:02:39   Config file: ./config/run_relation_transductive_mech_1.yaml
17:02:39   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'AristoV4',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 8,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:02:45   AristoV4 dataset
17:02:45   #train: 242567, #valid: 20000, #test: 20000
17:02:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:46   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:29:36   mr: 23.7748
17:29:36   mrr: 0.385567
17:29:36   hits@1: 0.26185
17:29:36   hits@3: 0.426
17:29:36   hits@10: 0.6449
[0;32m[INFO][0m âœ“ å‘½ä»¤ 10 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:29:37
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 11: python src/run_relation.py -c ./config/run_relation_transductive_mech.yaml --dataset FB15k237_10 --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:29:37
17:29:40   Random seed: 128
17:29:40   Config file: ./config/run_relation_transductive_mech.yaml
17:29:40   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FB15k237_10',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:29:40   FB15k237_10 dataset
17:29:40   #train: 27211, #valid: 15624, #test: 18150
17:29:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:29:40   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:30:21   mr: 5.57978
17:30:21   mrr: 0.792162
17:30:21   hits@1: 0.710964
17:30:21   hits@3: 0.859229
17:30:21   hits@10: 0.928375
[0;32m[INFO][0m âœ“ å‘½ä»¤ 11 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:30:21
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 12: python src/run_relation.py -c ./config/run_relation_transductive_mech.yaml --dataset FB15k237_20 --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:30:21
17:30:24   Random seed: 128
17:30:24   Config file: ./config/run_relation_transductive_mech.yaml
17:30:24   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FB15k237_20',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:30:24   FB15k237_20 dataset
17:30:24   #train: 54423, #valid: 16963, #test: 19776
17:30:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:30:25   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:31:28   mr: 4.29374
17:31:28   mrr: 0.809799
17:31:28   hits@1: 0.734072
17:31:28   hits@3: 0.867971
17:31:28   hits@10: 0.941798
[0;32m[INFO][0m âœ“ å‘½ä»¤ 12 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:31:29
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 13: python src/run_relation.py -c ./config/run_relation_transductive_mech.yaml --dataset FB15k237_50 --epochs 0 --bpe null --seed 128 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0]
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:31:29
17:31:31   Random seed: 128
17:31:31   Config file: ./config/run_relation_transductive_mech.yaml
17:31:32   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FB15k237_50',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:31:32   FB15k237_50 dataset
17:31:32   #train: 136057, #valid: 17449, #test: 20324
17:31:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:31:33   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:33:43   mr: 2.81987
17:33:43   mrr: 0.862042
17:33:43   hits@1: 0.805796
17:33:43   hits@3: 0.903513
17:33:43   hits@10: 0.961523
[0;32m[INFO][0m âœ“ å‘½ä»¤ 13 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:33:44
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 14: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FB15k237Inductive --version v1 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:33:44
17:33:46   Random seed: 128
17:33:46   Config file: ./config/run_relation_inductive_mech.yaml
17:33:46   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v1'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:33:46   FB15k237Inductive(v1) dataset
17:33:46   #train: 4245, #valid: 489, #test: 411
17:33:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:33:47   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:33:48   mr: 8.08029
17:33:48   mrr: 0.71794
17:33:48   hits@1: 0.605839
17:33:48   hits@3: 0.815085
17:33:48   hits@10: 0.902676
[0;32m[INFO][0m âœ“ å‘½ä»¤ 14 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:33:48
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 15: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FB15k237Inductive --version v2 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:33:48
17:33:51   Random seed: 128
17:33:51   Config file: ./config/run_relation_inductive_mech.yaml
17:33:51   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v2'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:33:51   FB15k237Inductive(v2) dataset
17:33:51   #train: 9739, #valid: 1166, #test: 947
17:33:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:33:52   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:33:53   mr: 6.5396
17:33:53   mrr: 0.718542
17:33:53   hits@1: 0.590285
17:33:53   hits@3: 0.822598
17:33:53   hits@10: 0.922915
[0;32m[INFO][0m âœ“ å‘½ä»¤ 15 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:33:54
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 16: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FB15k237Inductive --version v3 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:33:54
17:33:56   Random seed: 128
17:33:56   Config file: ./config/run_relation_inductive_mech.yaml
17:33:56   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v3'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:33:56   FB15k237Inductive(v3) dataset
17:33:56   #train: 17986, #valid: 2194, #test: 1731
17:33:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:33:57   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:33:59   mr: 6.48411
17:33:59   mrr: 0.738385
17:33:59   hits@1: 0.626228
17:33:59   hits@3: 0.829001
17:33:59   hits@10: 0.931254
[0;32m[INFO][0m âœ“ å‘½ä»¤ 16 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:00
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 17: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FB15k237Inductive --version v4 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:00
17:34:02   Random seed: 128
17:34:02   Config file: ./config/run_relation_inductive_mech.yaml
17:34:02   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v4'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:02   FB15k237Inductive(v4) dataset
17:34:02   #train: 27203, #valid: 3352, #test: 2840
17:34:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:03   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:07   mr: 5.67782
17:34:07   mrr: 0.746543
17:34:07   hits@1: 0.632394
17:34:07   hits@3: 0.840493
17:34:07   hits@10: 0.941549
[0;32m[INFO][0m âœ“ å‘½ä»¤ 17 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:07
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 18: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WN18RRInductive --version v1 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:07
17:34:10   Random seed: 128
17:34:10   Config file: ./config/run_relation_inductive_mech.yaml
17:34:10   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WN18RRInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v1'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:10   WN18RRInductive(v1) dataset
17:34:10   #train: 5410, #valid: 630, #test: 373
17:34:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:10   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:11   mr: 1.40751
17:34:11   mrr: 0.828737
17:34:11   hits@1: 0.680965
17:34:11   hits@3: 0.989276
17:34:11   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 18 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:12
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 19: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WN18RRInductive --version v2 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:12
17:34:15   Random seed: 128
17:34:15   Config file: ./config/run_relation_inductive_mech.yaml
17:34:15   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WN18RRInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v2'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:15   WN18RRInductive(v2) dataset
17:34:15   #train: 15262, #valid: 1838, #test: 852
17:34:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:15   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:17   mr: 1.48709
17:34:17   mrr: 0.805269
17:34:17   hits@1: 0.643192
17:34:17   hits@3: 0.982394
17:34:17   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 19 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:17
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 20: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WN18RRInductive --version v3 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:17
17:34:20   Random seed: 128
17:34:20   Config file: ./config/run_relation_inductive_mech.yaml
17:34:20   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WN18RRInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v3'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:20   WN18RRInductive(v3) dataset
17:34:20   #train: 25901, #valid: 3097, #test: 1143
17:34:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:21   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:23   mr: 1.50481
17:34:23   mrr: 0.806017
17:34:23   hits@1: 0.650919
17:34:23   hits@3: 0.96413
17:34:23   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 20 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:23
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 21: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WN18RRInductive --version v4 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:23
17:34:26   Random seed: 128
17:34:26   Config file: ./config/run_relation_inductive_mech.yaml
17:34:26   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WN18RRInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v4'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:26   WN18RRInductive(v4) dataset
17:34:26   #train: 7940, #valid: 934, #test: 2823
17:34:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:26   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:33   mr: 1.40914
17:34:34   mrr: 0.831421
17:34:34   hits@1: 0.688629
17:34:34   hits@3: 0.984414
17:34:34   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 21 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:34
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 22: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NELLInductive --version v1 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:34
17:34:37   Random seed: 128
17:34:37   Config file: ./config/run_relation_inductive_mech.yaml
17:34:37   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NELLInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v1'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:37   NELLInductive(v1) dataset
17:34:37   #train: 4687, #valid: 414, #test: 201
17:34:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:37   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:38   mr: 2.9403
17:34:38   mrr: 0.495854
17:34:38   hits@1: 0.258706
17:34:38   hits@3: 0.800995
17:34:38   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 22 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:39
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 23: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NELLInductive --version v2 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:39
17:34:41   Random seed: 128
17:34:41   Config file: ./config/run_relation_inductive_mech.yaml
17:34:41   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NELLInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v2'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:41   NELLInductive(v2) dataset
17:34:41   #train: 8219, #valid: 922, #test: 935
17:34:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:42   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:43   mr: 3.53369
17:34:43   mrr: 0.796939
17:34:43   hits@1: 0.712299
17:34:43   hits@3: 0.865241
17:34:43   hits@10: 0.930481
[0;32m[INFO][0m âœ“ å‘½ä»¤ 23 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:44
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 24: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NELLInductive --version v3 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:44
17:34:46   Random seed: 128
17:34:46   Config file: ./config/run_relation_inductive_mech.yaml
17:34:46   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NELLInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v3'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:47   NELLInductive(v3) dataset
17:34:47   #train: 16393, #valid: 1851, #test: 1620
17:34:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:47   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:49   mr: 3.69383
17:34:49   mrr: 0.737913
17:34:49   hits@1: 0.616049
17:34:49   hits@3: 0.84321
17:34:49   hits@10: 0.945679
[0;32m[INFO][0m âœ“ å‘½ä»¤ 24 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:50
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 25: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NELLInductive --version v4 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:50
17:34:53   Random seed: 128
17:34:53   Config file: ./config/run_relation_inductive_mech.yaml
17:34:53   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NELLInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v4'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:34:53   NELLInductive(v4) dataset
17:34:53   #train: 7546, #valid: 876, #test: 1447
17:34:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:53   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:34:55   mr: 2.22737
17:34:55   mrr: 0.822392
17:34:55   hits@1: 0.737388
17:34:55   hits@3: 0.885971
17:34:55   hits@10: 0.975121
[0;32m[INFO][0m âœ“ å‘½ä»¤ 25 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:34:56
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 26: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset ILPC2022 --version small --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:34:56
17:34:59   Random seed: 128
17:34:59   Config file: ./config/run_relation_inductive_mech.yaml
17:34:59   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'ILPC2022',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'small'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:35:00   ILPC2022(small) dataset
17:35:00   #train: 78616, #valid: 2908, #test: 2902
17:35:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:35:01   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:35:08   mr: 1.41971
17:35:08   mrr: 0.927281
17:35:08   hits@1: 0.881461
17:35:08   hits@3: 0.970021
17:35:08   hits@10: 0.986561
[0;32m[INFO][0m âœ“ å‘½ä»¤ 26 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:35:08
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 27: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset ILPC2022 --version large --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:35:08
17:35:11   Random seed: 128
17:35:11   Config file: ./config/run_relation_inductive_mech.yaml
17:35:11   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'ILPC2022',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'large'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:35:14   ILPC2022(large) dataset
17:35:14   #train: 202446, #valid: 10179, #test: 10184
17:35:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:35:15   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:36:30   mr: 1.57875
17:36:30   mrr: 0.893125
17:36:31   hits@1: 0.829537
17:36:31   hits@3: 0.947074
17:36:31   hits@10: 0.984976
[0;32m[INFO][0m âœ“ å‘½ä»¤ 27 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:36:31
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 28: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset HM --version 1k --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:36:31
17:36:34   Random seed: 128
17:36:34   Config file: ./config/run_relation_inductive_mech.yaml
17:36:34   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'HM',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': '1k'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:36:34   HM(1k) dataset
17:36:34   #train: 93364, #valid: 1771, #test: 476
17:36:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:36:35   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:36:36   mr: 1.91176
17:36:36   mrr: 0.699083
17:36:36   hits@1: 0.495798
17:36:36   hits@3: 0.886555
17:36:36   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 28 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:36:37
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 29: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset HM --version 3k --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:36:37
17:36:40   Random seed: 128
17:36:40   Config file: ./config/run_relation_inductive_mech.yaml
17:36:40   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'HM',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': '3k'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:36:40   HM(3k) dataset
17:36:40   #train: 71097, #valid: 1201, #test: 1349
17:36:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:36:40   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:36:49   mr: 1.99703
17:36:49   mrr: 0.684388
17:36:49   hits@1: 0.478873
17:36:49   hits@3: 0.884359
17:36:49   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 29 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:36:50
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 30: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset HM --version 5k --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:36:50
17:36:53   Random seed: 128
17:36:53   Config file: ./config/run_relation_inductive_mech.yaml
17:36:53   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'HM',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': '5k'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:36:53   HM(5k) dataset
17:36:53   #train: 57601, #valid: 900, #test: 2124
17:36:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:36:54   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:37:11   mr: 1.99765
17:37:11   mrr: 0.687488
17:37:11   hits@1: 0.488701
17:37:11   hits@3: 0.877119
17:37:11   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 30 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:37:12
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 31: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset HM --version indigo --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:37:12
17:37:15   Random seed: 128
17:37:15   Config file: ./config/run_relation_inductive_mech.yaml
17:37:15   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'HM',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'indigo'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:37:16   HM(indigo) dataset
17:37:16   #train: 121601, #valid: 14121, #test: 14904
17:37:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:37:16   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:39:44   mr: 1.97678
17:39:44   mrr: 0.853295
17:39:44   hits@1: 0.766036
17:39:44   hits@3: 0.93183
17:39:44   hits@10: 0.983427
[0;32m[INFO][0m âœ“ å‘½ä»¤ 31 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:39:45
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 32: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBIngram --version 25 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:39:45
17:39:47   Random seed: 128
17:39:47   Config file: ./config/run_relation_inductive_mech.yaml
17:39:47   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FBIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 25},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:39:48   FBIngram(25) dataset
17:39:48   #train: 91571, #valid: 5716, #test: 5716
17:39:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:39:48   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:39:58   mr: 5.05458
17:39:58   mrr: 0.800166
17:39:58   hits@1: 0.711512
17:39:58   hits@3: 0.877712
17:39:58   hits@10: 0.938244
[0;32m[INFO][0m âœ“ å‘½ä»¤ 32 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:39:59
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 33: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBIngram --version 50 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:39:59
17:40:01   Random seed: 128
17:40:01   Config file: ./config/run_relation_inductive_mech.yaml
17:40:01   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FBIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 50},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:40:02   FBIngram(50) dataset
17:40:02   #train: 85375, #valid: 3879, #test: 3879
17:40:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:02   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:40:08   mr: 5.85254
17:40:08   mrr: 0.787413
17:40:08   hits@1: 0.707399
17:40:08   hits@3: 0.850477
17:40:08   hits@10: 0.909255
[0;32m[INFO][0m âœ“ å‘½ä»¤ 33 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:40:09
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 34: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBIngram --version 75 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:40:09
17:40:12   Random seed: 128
17:40:12   Config file: ./config/run_relation_inductive_mech.yaml
17:40:12   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FBIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 75},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:40:12   FBIngram(75) dataset
17:40:12   #train: 62809, #valid: 3106, #test: 3106
17:40:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:13   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:40:16   mr: 4.75016
17:40:16   mrr: 0.811384
17:40:16   hits@1: 0.729234
17:40:16   hits@3: 0.87669
17:40:16   hits@10: 0.934643
[0;32m[INFO][0m âœ“ å‘½ä»¤ 34 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:40:17
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 35: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBIngram --version 100 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:40:17
17:40:20   Random seed: 128
17:40:20   Config file: ./config/run_relation_inductive_mech.yaml
17:40:20   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FBIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 100},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:40:20   FBIngram(100) dataset
17:40:20   #train: 62809, #valid: 2329, #test: 2329
17:40:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:20   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:40:23   mr: 2.01202
17:40:23   mrr: 0.919473
17:40:23   hits@1: 0.878059
17:40:23   hits@3: 0.957922
17:40:23   hits@10: 0.975097
[0;32m[INFO][0m âœ“ å‘½ä»¤ 35 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:40:24
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 36: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WKIngram --version 25 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:40:24
17:40:26   Random seed: 128
17:40:26   Config file: ./config/run_relation_inductive_mech.yaml
17:40:26   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WKIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 25},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:40:27   WKIngram(25) dataset
17:40:27   #train: 41873, #valid: 1130, #test: 1131
17:40:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:27   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:40:29   mr: 1.96198
17:40:29   mrr: 0.881758
17:40:29   hits@1: 0.811671
17:40:29   hits@3: 0.937224
17:40:29   hits@10: 0.981432
[0;32m[INFO][0m âœ“ å‘½ä»¤ 36 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:40:29
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 37: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WKIngram --version 50 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:40:29
17:40:32   Random seed: 128
17:40:32   Config file: ./config/run_relation_inductive_mech.yaml
17:40:32   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WKIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 50},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:40:32   WKIngram(50) dataset
17:40:32   #train: 82481, #valid: 3224, #test: 3225
17:40:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:33   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:40:38   mr: 2.46915
17:40:38   mrr: 0.882019
17:40:38   hits@1: 0.826046
17:40:38   hits@3: 0.928682
17:40:38   hits@10: 0.95969
[0;32m[INFO][0m âœ“ å‘½ä»¤ 37 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:40:39
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 38: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WKIngram --version 75 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:40:39
17:40:41   Random seed: 128
17:40:41   Config file: ./config/run_relation_inductive_mech.yaml
17:40:41   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WKIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 75},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:40:42   WKIngram(75) dataset
17:40:42   #train: 28741, #valid: 1143, #test: 1144
17:40:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:42   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:40:44   mr: 1.93531
17:40:44   mrr: 0.934148
17:40:44   hits@1: 0.906469
17:40:44   hits@3: 0.956294
17:40:44   hits@10: 0.97465
[0;32m[INFO][0m âœ“ å‘½ä»¤ 38 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:40:44
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 39: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WKIngram --version 100 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:40:44
17:40:47   Random seed: 128
17:40:47   Config file: ./config/run_relation_inductive_mech.yaml
17:40:47   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WKIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 100},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:40:47   WKIngram(100) dataset
17:40:47   #train: 49875, #valid: 4496, #test: 4496
17:40:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:48   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:40:57   mr: 1.70173
17:40:57   mrr: 0.917812
17:40:57   hits@1: 0.884564
17:40:57   hits@3: 0.941281
17:40:57   hits@10: 0.966859
[0;32m[INFO][0m âœ“ å‘½ä»¤ 39 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:40:57
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 40: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 0 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:40:57
17:41:00   Random seed: 128
17:41:00   Config file: ./config/run_relation_inductive_mech.yaml
17:41:00   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 0},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:00   NLIngram(0) dataset
17:41:00   #train: 7796, #valid: 763, #test: 763
17:41:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:00   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:02   mr: 6.96592
17:41:02   mrr: 0.659504
17:41:02   hits@1: 0.53211
17:41:02   hits@3: 0.757536
17:41:02   hits@10: 0.884666
[0;32m[INFO][0m âœ“ å‘½ä»¤ 40 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:02
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 41: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 25 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:03
17:41:05   Random seed: 128
17:41:05   Config file: ./config/run_relation_inductive_mech.yaml
17:41:05   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 25},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:05   NLIngram(25) dataset
17:41:05   #train: 17578, #valid: 743, #test: 744
17:41:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:05   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:07   mr: 5.37231
17:41:07   mrr: 0.72463
17:41:07   hits@1: 0.575269
17:41:07   hits@3: 0.880376
17:41:07   hits@10: 0.923387
[0;32m[INFO][0m âœ“ å‘½ä»¤ 41 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:07
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 42: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 50 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:07
17:41:10   Random seed: 128
17:41:10   Config file: ./config/run_relation_inductive_mech.yaml
17:41:10   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 50},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:10   NLIngram(50) dataset
17:41:10   #train: 17578, #valid: 859, #test: 859
17:41:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:10   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:12   mr: 4.7241
17:41:12   mrr: 0.764001
17:41:12   hits@1: 0.66007
17:41:12   hits@3: 0.846333
17:41:12   hits@10: 0.920838
[0;32m[INFO][0m âœ“ å‘½ä»¤ 42 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:12
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 43: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 75 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:13
17:41:15   Random seed: 128
17:41:15   Config file: ./config/run_relation_inductive_mech.yaml
17:41:15   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 75},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:15   NLIngram(75) dataset
17:41:15   #train: 11058, #valid: 606, #test: 607
17:41:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:16   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:17   mr: 4.14168
17:41:17   mrr: 0.814987
17:41:17   hits@1: 0.734761
17:41:17   hits@3: 0.889621
17:41:17   hits@10: 0.93575
[0;32m[INFO][0m âœ“ å‘½ä»¤ 43 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:17
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 44: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 100 --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:17
17:41:20   Random seed: 128
17:41:20   Config file: ./config/run_relation_inductive_mech.yaml
17:41:20   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 100},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:20   NLIngram(100) dataset
17:41:20   #train: 7832, #valid: 793, #test: 793
17:41:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:21   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:22   mr: 1.48298
17:41:22   mrr: 0.873051
17:41:22   hits@1: 0.779319
17:41:22   hits@3: 0.97604
17:41:22   hits@10: 0.994956
[0;32m[INFO][0m âœ“ å‘½ä»¤ 44 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:23
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 45: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT1 --version tax --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:23
17:41:25   Random seed: 128
17:41:25   Config file: ./config/run_relation_inductive_mech.yaml
17:41:25   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WikiTopicsMT1',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'tax'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:25   WikiTopicsMT1(tax) dataset
17:41:25   #train: 17178, #valid: 1908, #test: 1834
17:41:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:26   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:31   mr: 1.02672
17:41:31   mrr: 0.989913
17:41:32   hits@1: 0.982552
17:41:32   hits@3: 0.997819
17:41:32   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 45 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:32
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 46: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT1 --version health --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:32
17:41:35   Random seed: 128
17:41:35   Config file: ./config/run_relation_inductive_mech.yaml
17:41:35   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WikiTopicsMT1',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'health'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:35   WikiTopicsMT1(health) dataset
17:41:35   #train: 14371, #valid: 1596, #test: 1566
17:41:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:35   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:39   mr: 1.05811
17:41:39   mrr: 0.974989
17:41:39   hits@1: 0.953384
17:41:39   hits@3: 0.997446
17:41:39   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 46 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:40
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 47: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT2 --version org --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:40
17:41:42   Random seed: 128
17:41:42   Config file: ./config/run_relation_inductive_mech.yaml
17:41:43   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WikiTopicsMT2',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'org'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:43   WikiTopicsMT2(org) dataset
17:41:43   #train: 23233, #valid: 2581, #test: 2441
17:41:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:43   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:48   mr: 1.02745
17:41:48   mrr: 0.988598
17:41:48   hits@1: 0.978697
17:41:48   hits@3: 0.999181
17:41:48   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 47 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:49
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 48: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT2 --version sci --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:49
17:41:52   Random seed: 128
17:41:52   Config file: ./config/run_relation_inductive_mech.yaml
17:41:52   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WikiTopicsMT2',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'sci'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:41:52   WikiTopicsMT2(sci) dataset
17:41:52   #train: 16471, #valid: 1830, #test: 1650
17:41:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:52   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:41:56   mr: 1.07455
17:41:56   mrr: 0.978461
17:41:56   hits@1: 0.962424
17:41:56   hits@3: 0.995152
17:41:56   hits@10: 0.998788
[0;32m[INFO][0m âœ“ å‘½ä»¤ 48 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:41:57
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 49: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT3 --version art --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:41:57
17:42:00   Random seed: 128
17:42:00   Config file: ./config/run_relation_inductive_mech.yaml
17:42:00   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WikiTopicsMT3',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'art'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:42:00   WikiTopicsMT3(art) dataset
17:42:00   #train: 27262, #valid: 3026, #test: 3113
17:42:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:00   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:42:12   mr: 1.61131
17:42:12   mrr: 0.898139
17:42:12   hits@1: 0.843559
17:42:12   hits@3: 0.939608
17:42:12   hits@10: 0.984902
[0;32m[INFO][0m âœ“ å‘½ä»¤ 49 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:42:12
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 50: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT3 --version infra --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:42:12
17:42:15   Random seed: 128
17:42:15   Config file: ./config/run_relation_inductive_mech.yaml
17:42:15   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WikiTopicsMT3',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'infra'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:42:15   WikiTopicsMT3(infra) dataset
17:42:15   #train: 21990, #valid: 2443, #test: 2405
17:42:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:15   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:42:22   mr: 1.12391
17:42:22   mrr: 0.967659
17:42:22   hits@1: 0.948441
17:42:22   hits@3: 0.983368
17:42:22   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 50 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:42:23
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 51: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT4 --version sci --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:42:23
17:42:25   Random seed: 128
17:42:25   Config file: ./config/run_relation_inductive_mech.yaml
17:42:25   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WikiTopicsMT4',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'sci'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:42:26   WikiTopicsMT4(sci) dataset
17:42:26   #train: 12576, #valid: 1397, #test: 1388
17:42:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:26   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:42:29   mr: 1.14769
17:42:29   mrr: 0.960408
17:42:29   hits@1: 0.932277
17:42:29   hits@3: 0.988473
17:42:29   hits@10: 0.997839
[0;32m[INFO][0m âœ“ å‘½ä»¤ 51 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:42:30
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 52: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT4 --version health --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:42:30
17:42:32   Random seed: 128
17:42:32   Config file: ./config/run_relation_inductive_mech.yaml
17:42:32   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'WikiTopicsMT4',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'health'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:42:32   WikiTopicsMT4(health) dataset
17:42:32   #train: 15539, #valid: 1725, #test: 1703
17:42:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:33   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:42:37   mr: 1.15502
17:42:37   mrr: 0.953224
17:42:37   hits@1: 0.919554
17:42:37   hits@3: 0.984733
17:42:37   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 52 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:42:38
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 53: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset Metafam --version null --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:42:38
17:42:40   Random seed: 128
17:42:40   Config file: ./config/run_relation_inductive_mech.yaml
17:42:40   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'Metafam',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': None},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:42:40   Metafam(None) dataset
17:42:40   #train: 13821, #valid: 590, #test: 184
17:42:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:41   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:42:42   mr: 8.77174
17:42:42   mrr: 0.129175
17:42:42   hits@1: 0
17:42:42   hits@3: 0.0108696
17:42:42   hits@10: 0.673913
[0;32m[INFO][0m âœ“ å‘½ä»¤ 53 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:42:42
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 54: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBNELL --version null --ckpt /T20030104/ynj/TRIX/ckpts/128.pth --gpus [0] --epochs 0 --bpe null --seed 128
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2026-01-05 17:42:42
17:42:45   Random seed: 128
17:42:45   Config file: ./config/run_relation_inductive_mech.yaml
17:42:45   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/128.pth',
 'dataset': {'class': 'FBNELL',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': None},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
17:42:45   FBNELL(None) dataset
17:42:45   #train: 10275, #valid: 1055, #test: 597
17:42:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:45   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
17:42:47   mr: 5.42044
17:42:47   mrr: 0.728568
17:42:47   hits@1: 0.586265
17:42:47   hits@3: 0.876047
17:42:47   hits@10: 0.934673
[0;32m[INFO][0m âœ“ å‘½ä»¤ 54 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2026-01-05 17:42:47
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå®Œæˆï¼
[0;32m[INFO][0m æ€»å‘½ä»¤æ•°: 54
[0;32m[INFO][0m æˆåŠŸ: 54
[0;32m[INFO][0m å¤±è´¥: 0
[0;32m[INFO][0m æ—¥å¿—æ–‡ä»¶: run_commands_20260105_113925.log
[0;32m[INFO][0m æ‰€æœ‰å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼
