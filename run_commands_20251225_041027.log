[0;32m[INFO][0m æ­£åœ¨æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ: trix
[0;32m[INFO][0m è™šæ‹ŸçŽ¯å¢ƒ trix å·²æ¿€æ´»
[0;32m[INFO][0m å½“å‰å·¥ä½œç›®å½•: /T20030104/ynj/TRIX
[0;32m[INFO][0m å¼€å§‹è¯»å–å‘½ä»¤æ–‡ä»¶: command_rel.md
[0;32m[INFO][0m æ—¥å¿—å°†ä¿å­˜åˆ°: run_commands_20251225_041027.log
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 1: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FB15k237Inductive --version v1 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:10:28
04:10:31   Random seed: 1024
04:10:31   Config file: ./config/run_relation_inductive_mech.yaml
04:10:31   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v1'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:10:31   FB15k237Inductive(v1) dataset
04:10:31   #train: 4245, #valid: 489, #test: 411
04:10:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:10:31   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:10:32   mr: 8.05839
04:10:32   mrr: 0.66269
04:10:32   hits@1: 0.518248
04:10:32   hits@3: 0.781022
04:10:32   hits@10: 0.900243
[0;32m[INFO][0m âœ“ å‘½ä»¤ 1 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:10:33
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 2: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FB15k237Inductive --version v2 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:10:33
04:10:35   Random seed: 1024
04:10:35   Config file: ./config/run_relation_inductive_mech.yaml
04:10:35   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v2'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:10:36   FB15k237Inductive(v2) dataset
04:10:36   #train: 9739, #valid: 1166, #test: 947
04:10:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:10:36   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:10:37   mr: 7.65998
04:10:37   mrr: 0.686485
04:10:37   hits@1: 0.539599
04:10:37   hits@3: 0.807814
04:10:37   hits@10: 0.911299
[0;32m[INFO][0m âœ“ å‘½ä»¤ 2 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:10:38
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 3: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FB15k237Inductive --version v3 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:10:38
04:10:41   Random seed: 1024
04:10:41   Config file: ./config/run_relation_inductive_mech.yaml
04:10:41   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v3'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:10:41   FB15k237Inductive(v3) dataset
04:10:41   #train: 17986, #valid: 2194, #test: 1731
04:10:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:10:41   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:10:43   mr: 6.91392
04:10:43   mrr: 0.706387
04:10:43   hits@1: 0.584055
04:10:43   hits@3: 0.798382
04:10:43   hits@10: 0.916233
[0;32m[INFO][0m âœ“ å‘½ä»¤ 3 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:10:44
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 4: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FB15k237Inductive --version v4 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:10:44
04:10:47   Random seed: 1024
04:10:47   Config file: ./config/run_relation_inductive_mech.yaml
04:10:47   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v4'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:10:47   FB15k237Inductive(v4) dataset
04:10:47   #train: 27203, #valid: 3352, #test: 2840
04:10:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:10:47   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:10:51   mr: 6.44718
04:10:51   mrr: 0.721929
04:10:51   hits@1: 0.604577
04:10:51   hits@3: 0.809859
04:10:51   hits@10: 0.927817
[0;32m[INFO][0m âœ“ å‘½ä»¤ 4 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:10:51
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 5: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WN18RRInductive --version v1 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:10:51
04:10:54   Random seed: 1024
04:10:54   Config file: ./config/run_relation_inductive_mech.yaml
04:10:54   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WN18RRInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v1'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:10:54   WN18RRInductive(v1) dataset
04:10:54   #train: 5410, #valid: 630, #test: 373
04:10:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:10:54   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:10:55   mr: 1.42091
04:10:55   mrr: 0.833259
04:10:55   hits@1: 0.697051
04:10:55   hits@3: 0.991957
04:10:55   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 5 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:10:56
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 6: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WN18RRInductive --version v2 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:10:56
04:10:59   Random seed: 1024
04:10:59   Config file: ./config/run_relation_inductive_mech.yaml
04:10:59   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WN18RRInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v2'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:10:59   WN18RRInductive(v2) dataset
04:10:59   #train: 15262, #valid: 1838, #test: 852
04:10:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:10:59   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:11:01   mr: 1.5
04:11:01   mrr: 0.809679
04:11:01   hits@1: 0.660798
04:11:01   hits@3: 0.976526
04:11:01   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 6 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:11:01
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 7: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WN18RRInductive --version v3 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:11:01
04:11:04   Random seed: 1024
04:11:04   Config file: ./config/run_relation_inductive_mech.yaml
04:11:04   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WN18RRInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v3'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:11:04   WN18RRInductive(v3) dataset
04:11:04   #train: 25901, #valid: 3097, #test: 1143
04:11:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:04   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:11:06   mr: 1.46282
04:11:06   mrr: 0.826679
04:11:06   hits@1: 0.692913
04:11:06   hits@3: 0.956255
04:11:06   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 7 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:11:07
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 8: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WN18RRInductive --version v4 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:11:07
04:11:09   Random seed: 1024
04:11:09   Config file: ./config/run_relation_inductive_mech.yaml
04:11:09   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WN18RRInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v4'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:11:09   WN18RRInductive(v4) dataset
04:11:09   #train: 7940, #valid: 934, #test: 2823
04:11:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:10   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:11:17   mr: 1.55473
04:11:17   mrr: 0.781058
04:11:17   hits@1: 0.604676
04:11:17   hits@3: 0.969182
04:11:17   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 8 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:11:17
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 9: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NELLInductive --version v1 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:11:18
04:11:20   Random seed: 1024
04:11:20   Config file: ./config/run_relation_inductive_mech.yaml
04:11:20   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NELLInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v1'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:11:20   NELLInductive(v1) dataset
04:11:20   #train: 4687, #valid: 414, #test: 201
04:11:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:21   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:11:21   mr: 2.1791
04:11:21   mrr: 0.57131
04:11:21   hits@1: 0.303483
04:11:21   hits@3: 1
04:11:21   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 9 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:11:22
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 10: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NELLInductive --version v2 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:11:22
04:11:25   Random seed: 1024
04:11:25   Config file: ./config/run_relation_inductive_mech.yaml
04:11:25   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NELLInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v2'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:11:25   NELLInductive(v2) dataset
04:11:25   #train: 8219, #valid: 922, #test: 935
04:11:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:25   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:11:27   mr: 4.00749
04:11:27   mrr: 0.800791
04:11:27   hits@1: 0.727273
04:11:27   hits@3: 0.857754
04:11:27   hits@10: 0.91123
[0;32m[INFO][0m âœ“ å‘½ä»¤ 10 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:11:27
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 11: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NELLInductive --version v3 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:11:27
04:11:30   Random seed: 1024
04:11:30   Config file: ./config/run_relation_inductive_mech.yaml
04:11:30   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NELLInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v3'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:11:30   NELLInductive(v3) dataset
04:11:30   #train: 16393, #valid: 1851, #test: 1620
04:11:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:30   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:11:33   mr: 4.21543
04:11:33   mrr: 0.737777
04:11:34   hits@1: 0.627161
04:11:35   hits@3: 0.823457
04:11:35   hits@10: 0.937037
[0;32m[INFO][0m âœ“ å‘½ä»¤ 11 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:11:35
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 12: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NELLInductive --version v4 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:11:35
04:11:38   Random seed: 1024
04:11:38   Config file: ./config/run_relation_inductive_mech.yaml
04:11:38   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NELLInductive',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'v4'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:11:38   NELLInductive(v4) dataset
04:11:38   #train: 7546, #valid: 876, #test: 1447
04:11:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:38   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:11:40   mr: 2.81133
04:11:40   mrr: 0.797521
04:11:40   hits@1: 0.714582
04:11:40   hits@3: 0.852799
04:11:40   hits@10: 0.946786
[0;32m[INFO][0m âœ“ å‘½ä»¤ 12 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:11:41
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 13: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset ILPC2022 --version small --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:11:41
04:11:43   Random seed: 1024
04:11:43   Config file: ./config/run_relation_inductive_mech.yaml
04:11:43   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'ILPC2022',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'small'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:11:45   ILPC2022(small) dataset
04:11:45   #train: 78616, #valid: 2908, #test: 2902
04:11:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:45   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:11:52   mr: 1.49001
04:11:52   mrr: 0.905482
04:11:52   hits@1: 0.848725
04:11:52   hits@3: 0.95796
04:11:52   hits@10: 0.987939
[0;32m[INFO][0m âœ“ å‘½ä»¤ 13 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:11:53
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 14: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset ILPC2022 --version large --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:11:53
04:11:55   Random seed: 1024
04:11:55   Config file: ./config/run_relation_inductive_mech.yaml
04:11:55   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'ILPC2022',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'large'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:11:58   ILPC2022(large) dataset
04:11:58   #train: 202446, #valid: 10179, #test: 10184
04:11:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:59   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:13:15   mr: 1.77897
04:13:15   mrr: 0.853511
04:13:15   hits@1: 0.774352
04:13:15   hits@3: 0.923016
04:13:15   hits@10: 0.981441
[0;32m[INFO][0m âœ“ å‘½ä»¤ 14 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:13:15
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 15: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset HM --version 1k --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:13:15
04:13:18   Random seed: 1024
04:13:18   Config file: ./config/run_relation_inductive_mech.yaml
04:13:18   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'HM',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': '1k'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:13:18   HM(1k) dataset
04:13:18   #train: 93364, #valid: 1771, #test: 476
04:13:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:13:19   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:13:21   mr: 1.92017
04:13:21   mrr: 0.687826
04:13:21   hits@1: 0.462185
04:13:21   hits@3: 0.92437
04:13:21   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 15 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:13:21
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 16: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset HM --version 3k --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:13:21
04:13:24   Random seed: 1024
04:13:24   Config file: ./config/run_relation_inductive_mech.yaml
04:13:24   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'HM',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': '3k'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:13:24   HM(3k) dataset
04:13:24   #train: 71097, #valid: 1201, #test: 1349
04:13:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:13:25   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:13:33   mr: 1.93477
04:13:34   mrr: 0.689938
04:13:34   hits@1: 0.464789
04:13:34   hits@3: 0.909563
04:13:34   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 16 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:13:34
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 17: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset HM --version 5k --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:13:34
04:13:37   Random seed: 1024
04:13:37   Config file: ./config/run_relation_inductive_mech.yaml
04:13:37   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'HM',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': '5k'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:13:37   HM(5k) dataset
04:13:37   #train: 57601, #valid: 900, #test: 2124
04:13:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:13:37   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:13:55   mr: 1.86347
04:13:55   mrr: 0.700223
04:13:55   hits@1: 0.474105
04:13:55   hits@3: 0.9242
04:13:55   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 17 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:13:56
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 18: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset HM --version indigo --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:13:56
04:13:58   Random seed: 1024
04:13:58   Config file: ./config/run_relation_inductive_mech.yaml
04:13:59   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'HM',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'indigo'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:14:00   HM(indigo) dataset
04:14:00   #train: 121601, #valid: 14121, #test: 14904
04:14:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:14:00   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:16:28   mr: 2.9896
04:16:28   mrr: 0.822162
04:16:28   hits@1: 0.739265
04:16:28   hits@3: 0.885937
04:16:28   hits@10: 0.958803
[0;32m[INFO][0m âœ“ å‘½ä»¤ 18 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:16:29
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 19: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBIngram --version 25 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:16:29
04:16:31   Random seed: 1024
04:16:31   Config file: ./config/run_relation_inductive_mech.yaml
04:16:31   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FBIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 25},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:16:31   FBIngram(25) dataset
04:16:31   #train: 91571, #valid: 5716, #test: 5716
04:16:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:16:32   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:16:41   mr: 5.71868
04:16:41   mrr: 0.790341
04:16:41   hits@1: 0.70119
04:16:41   hits@3: 0.86739
04:16:41   hits@10: 0.929496
[0;32m[INFO][0m âœ“ å‘½ä»¤ 19 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:16:42
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 20: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBIngram --version 50 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:16:42
04:16:45   Random seed: 1024
04:16:45   Config file: ./config/run_relation_inductive_mech.yaml
04:16:45   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FBIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 50},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:16:45   FBIngram(50) dataset
04:16:45   #train: 85375, #valid: 3879, #test: 3879
04:16:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:16:45   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:16:52   mr: 6.39933
04:16:52   mrr: 0.756595
04:16:52   hits@1: 0.657902
04:16:52   hits@3: 0.842743
04:16:52   hits@10: 0.917505
[0;32m[INFO][0m âœ“ å‘½ä»¤ 20 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:16:52
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 21: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBIngram --version 75 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:16:52
04:16:55   Random seed: 1024
04:16:55   Config file: ./config/run_relation_inductive_mech.yaml
04:16:55   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FBIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 75},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:16:55   FBIngram(75) dataset
04:16:55   #train: 62809, #valid: 3106, #test: 3106
04:16:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:16:55   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:16:59   mr: 5.70702
04:16:59   mrr: 0.79136
04:16:59   hits@1: 0.705409
04:16:59   hits@3: 0.86349
04:16:59   hits@10: 0.929491
[0;32m[INFO][0m âœ“ å‘½ä»¤ 21 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:00
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 22: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBIngram --version 100 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:00
04:17:02   Random seed: 1024
04:17:02   Config file: ./config/run_relation_inductive_mech.yaml
04:17:02   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FBIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 100},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:02   FBIngram(100) dataset
04:17:02   #train: 62809, #valid: 2329, #test: 2329
04:17:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:03   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:06   mr: 2.08888
04:17:06   mrr: 0.912089
04:17:06   hits@1: 0.863031
04:17:06   hits@3: 0.957922
04:17:06   hits@10: 0.973809
[0;32m[INFO][0m âœ“ å‘½ä»¤ 22 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:06
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 23: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WKIngram --version 25 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:06
04:17:09   Random seed: 1024
04:17:09   Config file: ./config/run_relation_inductive_mech.yaml
04:17:09   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WKIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 25},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:09   WKIngram(25) dataset
04:17:09   #train: 41873, #valid: 1130, #test: 1131
04:17:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:09   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:11   mr: 1.84527
04:17:11   mrr: 0.931177
04:17:11   hits@1: 0.89832
04:17:11   hits@3: 0.959328
04:17:11   hits@10: 0.980548
[0;32m[INFO][0m âœ“ å‘½ä»¤ 23 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:12
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 24: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WKIngram --version 50 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:12
04:17:14   Random seed: 1024
04:17:14   Config file: ./config/run_relation_inductive_mech.yaml
04:17:14   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WKIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 50},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:14   WKIngram(50) dataset
04:17:14   #train: 82481, #valid: 3224, #test: 3225
04:17:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:15   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:20   mr: 2.30388
04:17:20   mrr: 0.910644
04:17:20   hits@1: 0.867287
04:17:20   hits@3: 0.948527
04:17:20   hits@10: 0.968372
[0;32m[INFO][0m âœ“ å‘½ä»¤ 24 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:21
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 25: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WKIngram --version 75 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:21
04:17:23   Random seed: 1024
04:17:23   Config file: ./config/run_relation_inductive_mech.yaml
04:17:23   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WKIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 75},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:23   WKIngram(75) dataset
04:17:23   #train: 28741, #valid: 1143, #test: 1144
04:17:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:24   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:25   mr: 2.07955
04:17:25   mrr: 0.93046
04:17:25   hits@1: 0.902972
04:17:25   hits@3: 0.95979
04:17:25   hits@10: 0.972902
[0;32m[INFO][0m âœ“ å‘½ä»¤ 25 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:26
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 26: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WKIngram --version 100 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:26
04:17:28   Random seed: 1024
04:17:28   Config file: ./config/run_relation_inductive_mech.yaml
04:17:28   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WKIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 100},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:29   WKIngram(100) dataset
04:17:29   #train: 49875, #valid: 4496, #test: 4496
04:17:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:29   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:38   mr: 1.75423
04:17:38   mrr: 0.920368
04:17:38   hits@1: 0.888568
04:17:38   hits@3: 0.941504
04:17:38   hits@10: 0.968639
[0;32m[INFO][0m âœ“ å‘½ä»¤ 26 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:38
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 27: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 0 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:39
04:17:41   Random seed: 1024
04:17:41   Config file: ./config/run_relation_inductive_mech.yaml
04:17:41   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 0},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:41   NLIngram(0) dataset
04:17:41   #train: 7796, #valid: 763, #test: 763
04:17:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:42   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:43   mr: 6.94626
04:17:43   mrr: 0.655546
04:17:43   hits@1: 0.521625
04:17:43   hits@3: 0.757536
04:17:43   hits@10: 0.89384
[0;32m[INFO][0m âœ“ å‘½ä»¤ 27 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:43
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 28: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 25 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:43
04:17:46   Random seed: 1024
04:17:46   Config file: ./config/run_relation_inductive_mech.yaml
04:17:46   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 25},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:46   NLIngram(25) dataset
04:17:46   #train: 17578, #valid: 743, #test: 744
04:17:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:46   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:48   mr: 5.85618
04:17:48   mrr: 0.751396
04:17:48   hits@1: 0.633065
04:17:48   hits@3: 0.865591
04:17:48   hits@10: 0.932796
[0;32m[INFO][0m âœ“ å‘½ä»¤ 28 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:48
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 29: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 50 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:48
04:17:51   Random seed: 1024
04:17:51   Config file: ./config/run_relation_inductive_mech.yaml
04:17:51   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 50},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:51   NLIngram(50) dataset
04:17:51   #train: 17578, #valid: 859, #test: 859
04:17:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:51   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:53   mr: 4.44354
04:17:53   mrr: 0.77668
04:17:53   hits@1: 0.684517
04:17:53   hits@3: 0.85099
04:17:53   hits@10: 0.933644
[0;32m[INFO][0m âœ“ å‘½ä»¤ 29 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:53
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 30: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 75 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:53
04:17:56   Random seed: 1024
04:17:56   Config file: ./config/run_relation_inductive_mech.yaml
04:17:56   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 75},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:17:56   NLIngram(75) dataset
04:17:56   #train: 11058, #valid: 606, #test: 607
04:17:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:56   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:17:58   mr: 4.5799
04:17:58   mrr: 0.797633
04:17:58   hits@1: 0.706755
04:17:58   hits@3: 0.871499
04:17:58   hits@10: 0.947282
[0;32m[INFO][0m âœ“ å‘½ä»¤ 30 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:17:58
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 31: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset NLIngram --version 100 --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:17:58
04:18:01   Random seed: 1024
04:18:01   Config file: ./config/run_relation_inductive_mech.yaml
04:18:01   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'NLIngram',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 100},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:18:01   NLIngram(100) dataset
04:18:01   #train: 7832, #valid: 793, #test: 793
04:18:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:18:01   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:18:03   mr: 1.50441
04:18:03   mrr: 0.886797
04:18:03   hits@1: 0.805801
04:18:03   hits@3: 0.960908
04:18:03   hits@10: 0.993695
[0;32m[INFO][0m âœ“ å‘½ä»¤ 31 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:18:03
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 32: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT1 --version tax --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:18:03
04:18:06   Random seed: 1024
04:18:06   Config file: ./config/run_relation_inductive_mech.yaml
04:18:06   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WikiTopicsMT1',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'tax'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:18:06   WikiTopicsMT1(tax) dataset
04:18:06   #train: 17178, #valid: 1908, #test: 1834
04:18:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:18:06   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:18:12   mr: 1.01908
04:18:12   mrr: 0.993048
04:18:12   hits@1: 0.987459
04:18:12   hits@3: 0.998364
04:18:12   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 32 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:18:13
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 33: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT1 --version health --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:18:13
04:18:15   Random seed: 1024
04:18:15   Config file: ./config/run_relation_inductive_mech.yaml
04:18:15   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WikiTopicsMT1',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'health'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:18:15   WikiTopicsMT1(health) dataset
04:18:15   #train: 14371, #valid: 1596, #test: 1566
04:18:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:18:16   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:18:20   mr: 1.24074
04:18:20   mrr: 0.905981
04:18:21   hits@1: 0.835888
04:18:21   hits@3: 0.992976
04:18:21   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 33 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:18:23
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 34: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT2 --version org --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:18:23
04:18:26   Random seed: 1024
04:18:26   Config file: ./config/run_relation_inductive_mech.yaml
04:18:26   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WikiTopicsMT2',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'org'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:18:26   WikiTopicsMT2(org) dataset
04:18:26   #train: 23233, #valid: 2581, #test: 2441
04:18:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:18:26   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:18:32   mr: 1.03933
04:18:32   mrr: 0.985317
04:18:32   hits@1: 0.973781
04:18:32   hits@3: 0.997542
04:18:32   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 34 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:18:32
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 35: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT2 --version sci --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:18:32
04:18:35   Random seed: 1024
04:18:35   Config file: ./config/run_relation_inductive_mech.yaml
04:18:35   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WikiTopicsMT2',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'sci'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:18:35   WikiTopicsMT2(sci) dataset
04:18:35   #train: 16471, #valid: 1830, #test: 1650
04:18:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:18:35   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:18:39   mr: 1.06667
04:18:39   mrr: 0.983582
04:18:39   hits@1: 0.972121
04:18:39   hits@3: 0.992727
04:18:39   hits@10: 0.998182
[0;32m[INFO][0m âœ“ å‘½ä»¤ 35 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:18:42
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 36: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT3 --version art --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:18:43
04:18:46   Random seed: 1024
04:18:46   Config file: ./config/run_relation_inductive_mech.yaml
04:18:46   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WikiTopicsMT3',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'art'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:18:46   WikiTopicsMT3(art) dataset
04:18:46   #train: 27262, #valid: 3026, #test: 3113
04:18:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:18:47   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:18:58   mr: 1.83778
04:18:58   mrr: 0.877556
04:18:58   hits@1: 0.820109
04:18:58   hits@3: 0.923225
04:18:58   hits@10: 0.970446
[0;32m[INFO][0m âœ“ å‘½ä»¤ 36 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:18:59
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 37: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT3 --version infra --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:18:59
04:19:04   Random seed: 1024
04:19:04   Config file: ./config/run_relation_inductive_mech.yaml
04:19:04   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WikiTopicsMT3',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'infra'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:19:04   WikiTopicsMT3(infra) dataset
04:19:04   #train: 21990, #valid: 2443, #test: 2405
04:19:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:19:05   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:19:11   mr: 1.17505
04:19:11   mrr: 0.951363
04:19:11   hits@1: 0.919751
04:19:11   hits@3: 0.982121
04:19:11   hits@10: 0.998753
[0;32m[INFO][0m âœ“ å‘½ä»¤ 37 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:19:12
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 38: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT4 --version sci --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:19:12
04:19:14   Random seed: 1024
04:19:14   Config file: ./config/run_relation_inductive_mech.yaml
04:19:14   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WikiTopicsMT4',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'sci'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:19:15   WikiTopicsMT4(sci) dataset
04:19:15   #train: 12576, #valid: 1397, #test: 1388
04:19:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:19:15   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:19:18   mr: 1.13112
04:19:18   mrr: 0.97004
04:19:18   hits@1: 0.949568
04:19:18   hits@3: 0.990634
04:19:18   hits@10: 0.997839
[0;32m[INFO][0m âœ“ å‘½ä»¤ 38 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:19:19
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 39: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset WikiTopicsMT4 --version health --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:19:19
04:19:25   Random seed: 1024
04:19:25   Config file: ./config/run_relation_inductive_mech.yaml
04:19:25   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'WikiTopicsMT4',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': 'health'},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:19:25   WikiTopicsMT4(health) dataset
04:19:25   #train: 15539, #valid: 1725, #test: 1703
04:19:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:19:25   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:19:29   mr: 1.14093
04:19:29   mrr: 0.957087
04:19:29   hits@1: 0.925426
04:19:29   hits@3: 0.98943
04:19:29   hits@10: 0.998826
[0;32m[INFO][0m âœ“ å‘½ä»¤ 39 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:19:30
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 40: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset Metafam --version null --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:19:30
04:19:32   Random seed: 1024
04:19:32   Config file: ./config/run_relation_inductive_mech.yaml
04:19:32   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'Metafam',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': None},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:19:33   Metafam(None) dataset
04:19:33   #train: 13821, #valid: 590, #test: 184
04:19:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:19:33   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:19:34   mr: 3.6087
04:19:34   mrr: 0.330396
04:19:34   hits@1: 0.0326087
04:19:34   hits@3: 0.548913
04:19:34   hits@10: 1
[0;32m[INFO][0m âœ“ å‘½ä»¤ 40 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:19:34
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå‘½ä»¤ 41: python ./src/run_relation.py -c ./config/run_relation_inductive_mech.yaml --dataset FBNELL --version null --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth --gpus [0] --epochs 0 --bpe null
[0;32m[INFO][0m å¼€å§‹æ—¶é—´: 2025-12-25 04:19:34
04:19:37   Random seed: 1024
04:19:37   Config file: ./config/run_relation_inductive_mech.yaml
04:19:37   {'checkpoint': '/T20030104/ynj/TRIX/ckpts/rel_5.pth',
 'dataset': {'class': 'FBNELL',
             'root': '/T20030104/ynj/TRIX/kg-datasets_rel/',
             'version': None},
 'model': {'class': 'TRIXLatentMechanism',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'IndNBFNet',
                            'hidden_dims': [32, 32],
                            'input_dim': 32,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'mechanism': {'beta': 0.001,
                         'deterministic_eval': True,
                         'enabled': True,
                         'query_free': True,
                         'score_type': 'concat_mlp',
                         'z_dim': 32},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'NBFNet',
                              'hidden_dims': [32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True},
           'trix': {'feature_dim': 32, 'num_layer': 3, 'num_mlp_layer': 2}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/T20030104/ynj/TRIX/output_rel/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'InductiveInference',
          'num_negative': 256,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 32,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 0}}
04:19:37   FBNELL(None) dataset
04:19:37   #train: 10275, #valid: 1055, #test: 597
04:19:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:19:37   Evaluate on test
/root/anaconda3/envs/trix/lib/python3.10/site-packages/torch/utils/cpp_extension.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import packaging  # type: ignore[attr-defined]
Load rspmm extension. This may take a while...
04:19:39   mr: 5.75377
04:19:39   mrr: 0.753717
04:19:39   hits@1: 0.628141
04:19:39   hits@3: 0.865997
04:19:39   hits@10: 0.939698
[0;32m[INFO][0m âœ“ å‘½ä»¤ 41 æ‰§è¡ŒæˆåŠŸ
[0;32m[INFO][0m ç»“æŸæ—¶é—´: 2025-12-25 04:19:39
[0;32m[INFO][0m ==========================================
[0;32m[INFO][0m æ‰§è¡Œå®Œæˆï¼
[0;32m[INFO][0m æ€»å‘½ä»¤æ•°: 41
[0;32m[INFO][0m æˆåŠŸ: 41
[0;32m[INFO][0m å¤±è´¥: 0
[0;32m[INFO][0m æ—¥å¿—æ–‡ä»¶: run_commands_20251225_041027.log
[0;32m[INFO][0m æ‰€æœ‰å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼
