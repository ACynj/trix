output_dir: /T20030104/ynj/TRIX/output_rel/

dataset:
  class: {{ dataset }}
  root: /T20030104/ynj/TRIX/kg-datasets_rel/
  version: {{ version }}

model:
  class: TRIXLatentMechanism
  trix:
    feature_dim: 32
    num_layer: 3
    num_mlp_layer: 2
  relation_model:
    class: NBFNet
    input_dim: 32
    hidden_dims: [32, 32]
    message_func: distmult
    aggregate_func: sum
    short_cut: yes
    layer_norm: yes
  entity_model:
    class: IndNBFNet
    input_dim: 32
    hidden_dims: [32, 32]
    message_func: distmult
    aggregate_func: sum
    short_cut: yes
    layer_norm: yes
  mechanism:
    enabled: true
    z_dim: 32
    # 自适应beta：根据数据集规模调整
    # 小数据集(训练样本<10k): beta=1e-3
    # 中等数据集(10k-50k): beta=5e-4
    # 大数据集(>50k): beta=1e-4
    beta: {{ beta | default(1.0e-3) }}
    deterministic_eval: true
    score_type: concat_mlp
    query_free: true
    # 新增：KL warmup，前N个epoch逐渐增加beta
    kl_warmup_epochs: 0  # 0表示不使用warmup

task:
  name: InductiveInference
  num_negative: 256
  strict_negative: yes
  adversarial_temperature: 1
  metric: [mr, mrr, hits@1, hits@3, hits@10]

optimizer:
  class: AdamW
  lr: 5.0e-4

train:
  gpus: {{ gpus }}
  batch_size: 32
  num_epoch: {{ epochs }}
  log_interval: 100
  batch_per_epoch: {{ bpe }}

checkpoint: {{ ckpt }}

