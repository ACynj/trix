# å¿«é€Ÿæå‡æ™®é€‚æ€§ - å®æ–½æŒ‡å—

## ğŸ¯ æ ¸å¿ƒé—®é¢˜
å½“å‰æ–¹æ³•åœ¨éƒ¨åˆ†æ•°æ®é›†ä¸Šè¡¨ç°å¥½ï¼ˆWN18RRã€HMï¼‰ï¼Œä½†åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šä¸‹é™ï¼ˆFB15k237ã€ILPC2022ï¼‰ã€‚

## âš¡ æœ€å¿«è§æ•ˆçš„æ–¹æ¡ˆï¼šè°ƒæ•´Betaå€¼

### æ–¹æ¡ˆ1ï¼šæ‰‹åŠ¨æµ‹è¯•ä¸åŒBetaï¼ˆæ¨èå…ˆåšï¼‰

åœ¨è¡¨ç°å·®çš„æ•°æ®é›†ä¸Šæµ‹è¯•ä¸åŒbetaå€¼ï¼š

```bash
# FB15k237 v1 - æµ‹è¯•ä¸åŒbeta
python ./src/run_relation.py \
  -c ./config/run_relation_inductive_mech.yaml \
  --dataset FB15k237Inductive --version v1 \
  --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth \
  --gpus [0] --epochs 0 --bpe null \
  --beta 1.0e-4  # å°è¯•ï¼š1e-4, 5e-4, 1e-3, 2e-3
```

**é¢„æœŸç»“æœï¼š**
- beta=1e-4 æˆ– 5e-4 å¯èƒ½åœ¨FB15k237ä¸Šæ¢å¤æ€§èƒ½
- æ‰¾åˆ°æœ€ä¼˜betaåï¼Œæ›´æ–°é…ç½®æ–‡ä»¶

### æ–¹æ¡ˆ2ï¼šåˆ›å»ºæ•°æ®é›†ç‰¹å®šé…ç½®

ä¸ºè¡¨ç°å·®çš„æ•°æ®é›†åˆ›å»ºä¸“é—¨é…ç½®ï¼š

```bash
# å¤åˆ¶å½“å‰é…ç½®
cp config/run_relation_inductive_mech.yaml config/run_relation_inductive_mech_fb15k237.yaml

# ä¿®æ”¹betaå€¼
# åœ¨é…ç½®æ–‡ä»¶ä¸­å°† beta: 1.0e-3 æ”¹ä¸º beta: 1.0e-4
```

### æ–¹æ¡ˆ3ï¼šæ ¹æ®æ•°æ®é›†è§„æ¨¡è‡ªåŠ¨é€‰æ‹©Beta

åœ¨è®­ç»ƒè„šæœ¬ä¸­æ·»åŠ é€»è¾‘ï¼š

```python
# ä¼ªä»£ç ï¼Œéœ€è¦æ·»åŠ åˆ°run_relation.py
num_train_samples = len(train_data.target_edge_index[0])
if num_train_samples < 10000:
    beta = 1e-3
elif num_train_samples < 50000:
    beta = 5e-4
else:
    beta = 1e-4

# æ›´æ–°é…ç½®
cfg.model.mechanism.beta = beta
```

## ğŸ“Š å»ºè®®çš„å®éªŒé¡ºåº

### ç¬¬ä¸€æ­¥ï¼šå¿«é€ŸéªŒè¯ï¼ˆ1-2å°æ—¶ï¼‰
åœ¨FB15k237 v1ä¸Šæµ‹è¯•4ä¸ªbetaå€¼ï¼š
- beta = 1e-4
- beta = 5e-4  
- beta = 1e-3ï¼ˆå½“å‰ï¼‰
- beta = 2e-3

**ç›®æ ‡ï¼š** æ‰¾åˆ°èƒ½è®©FB15k237æ€§èƒ½æ¢å¤æˆ–è¶…è¿‡baselineçš„beta

### ç¬¬äºŒæ­¥ï¼šæ‰©å±•åˆ°å…¶ä»–æ•°æ®é›†ï¼ˆåŠå¤©ï¼‰
å¯¹ä»¥ä¸‹æ•°æ®é›†åˆ†åˆ«æ‰¾æœ€ä¼˜betaï¼š
- FB15k237 v2-v4
- ILPC2022 small/large
- FBIngram 25/50/75/100

**ç›®æ ‡ï¼š** å»ºç«‹"æ•°æ®é›†è§„æ¨¡ â†’ beta"çš„æ˜ å°„å…³ç³»

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯æ”¹è¿›ï¼ˆ1å¤©ï¼‰
ç”¨æ‰¾åˆ°çš„betaå€¼é‡æ–°è·‘æ‰€æœ‰æ•°æ®é›†ï¼Œå¯¹æ¯”ï¼š
- ä¹‹å‰è¡¨ç°å¥½çš„æ•°æ®é›†æ˜¯å¦ä»ç„¶å¥½
- ä¹‹å‰è¡¨ç°å·®çš„æ•°æ®é›†æ˜¯å¦æ”¹å–„

## ğŸ”§ å…·ä½“æ“ä½œæ­¥éª¤

### 1. ä¿®æ”¹é…ç½®æ–‡ä»¶æ”¯æŒbetaå‚æ•°

å¦‚æœé…ç½®æ–‡ä»¶ä¸æ”¯æŒå‘½ä»¤è¡Œä¼ betaï¼Œéœ€è¦ï¼š

**é€‰é¡¹Aï¼š** ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„betaå€¼
```yaml
# config/run_relation_inductive_mech.yaml
mechanism:
  beta: 1.0e-4  # æ”¹ä¸ºæµ‹è¯•å€¼
```

**é€‰é¡¹Bï¼š** ä½¿ç”¨æ¨¡æ¿å˜é‡ï¼ˆå¦‚æœæ”¯æŒï¼‰
```yaml
# config/run_relation_inductive_mech_adaptive.yaml
mechanism:
  beta: {{ beta | default(1.0e-3) }}
```

### 2. æ‰¹é‡æµ‹è¯•è„šæœ¬

åˆ›å»º `test_beta.sh`:
```bash
#!/bin/bash
for beta in 1.0e-4 5.0e-4 1.0e-3 2.0e-3; do
  echo "Testing beta=$beta"
  # ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„betaå€¼
  sed -i "s/beta: .*/beta: $beta/" config/run_relation_inductive_mech.yaml
  # è¿è¡Œæµ‹è¯•
  python ./src/run_relation.py \
    -c ./config/run_relation_inductive_mech.yaml \
    --dataset FB15k237Inductive --version v1 \
    --ckpt /T20030104/ynj/TRIX/ckpts/rel_5.pth \
    --gpus [0] --epochs 0 --bpe null
done
```

### 3. è®°å½•ç»“æœ

åˆ›å»ºç»“æœè¡¨æ ¼ï¼Œè®°å½•æ¯ä¸ªbetaçš„æ€§èƒ½ï¼š

| Beta | FB15k237 v1 MRR | FB15k237 v1 Hits@1 | ILPC2022 small MRR | ... |
|------|----------------|-------------------|-------------------|-----|
| 1e-4 | ? | ? | ? | ... |
| 5e-4 | ? | ? | ? | ... |
| 1e-3 | 0.663 | 0.518 | 0.905 | ... |
| 2e-3 | ? | ? | ? | ... |

## ğŸ¯ é¢„æœŸæ”¹è¿›

### çŸ­æœŸç›®æ ‡ï¼ˆ1-2å¤©ï¼‰
- FB15k237ç³»åˆ—ï¼šMRRæ¢å¤åˆ°0.68+ï¼ˆæ¥è¿‘baseline 0.69ï¼‰
- ILPC2022ï¼šMRRæ¢å¤åˆ°0.91+ï¼ˆæ¥è¿‘baseline 0.92ï¼‰

### ä¸­æœŸç›®æ ‡ï¼ˆ1å‘¨ï¼‰
- æ‰€æœ‰æ•°æ®é›†æ€§èƒ½ â‰¥ baseline
- å»ºç«‹è‡ªé€‚åº”betaè§„åˆ™

### é•¿æœŸç›®æ ‡ï¼ˆ2å‘¨+ï¼‰
- å®ç°è‡ªåŠ¨betaé€‰æ‹©
- åœ¨æ‰€æœ‰æ•°æ®é›†ä¸Šéƒ½æœ‰æå‡

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¿æŒå…¶ä»–è¶…å‚ä¸å˜**ï¼šåªæ”¹betaï¼Œç¡®ä¿å¯¹æ¯”å…¬å¹³
2. **ä½¿ç”¨ç›¸åŒcheckpoint**ï¼šéƒ½ç”¨rel_5.pth
3. **è®°å½•å®Œæ•´ç»“æœ**ï¼šä¿å­˜æ‰€æœ‰æŒ‡æ ‡ï¼Œä¾¿äºåˆ†æ
4. **å¤šæ¬¡è¿è¡Œ**ï¼šå¦‚æœæ—¶é—´å…è®¸ï¼Œæ¯ä¸ªbetaè·‘3æ¬¡å–å¹³å‡

## ğŸ“ ä¸‹ä¸€æ­¥

å®Œæˆbetaè°ƒä¼˜åï¼Œå¦‚æœè¿˜æœ‰æ•°æ®é›†è¡¨ç°å·®ï¼Œè€ƒè™‘ï¼š
1. è°ƒæ•´z_dimï¼ˆ16/32/64ï¼‰
2. æ”¹è¿›æœºåˆ¶ç¼–ç å™¨ï¼ˆå¢åŠ å±‚æ•°ï¼‰
3. ä½¿ç”¨KL warmupç­–ç•¥

è¯¦è§ `improve_generality.md` ä¸­çš„è¯¦ç»†æ–¹æ¡ˆã€‚



